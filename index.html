<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PadelPilot Master | Stable v4.0</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;500;800&family=Space+Grotesk:wght@300;700&display=swap');
        
        body, html { background-color: #F8FAFC; margin: 0; height: 100%; overflow: hidden; font-family: 'Plus Jakarta Sans', sans-serif; }
        .app-container { height: 100vh; display: flex; flex-direction: column; }
        .app-content { flex: 1; overflow-y: auto; padding-bottom: 150px; }
        
        .tab-view { display: none; height: 100%; }
        .tab-view.active { display: block; animation: fadeIn 0.2s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Arena Mode */
        #view-arena { background: #0f172a; font-family: 'Space Grotesk', sans-serif; color: white; }
        .arena-glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); border-radius: 2rem; }
        
        /* Navigation */
        .nav-dock { position: fixed; bottom: 0; width: 100%; background: #fff; border-top: 1px solid #eee; display: flex; justify-content: space-around; padding: 15px 0 30px 0; z-index: 100; }
        .nav-btn { display: flex; flex-direction: column; align-items: center; color: #94A3B8; font-size: 20px; border: none; background: none; }
        .nav-btn.active { color: #2563EB; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="app-content">
        
        <div id="view-arena" class="tab-view active px-5 pt-8">
            <h1 class="text-4xl font-black italic uppercase mb-6">THE <span class="text-yellow-400">ARENA</span></h1>
            
            <div class="arena-glass p-6 space-y-4">
                <div class="flex justify-between items-center">
                    <input id="timeInput" class="bg-transparent text-yellow-400 font-bold text-lg outline-none w-1/2">
                    <button id="checkInBtn" onclick="handleCheckIn()" class="bg-green-500/20 text-green-400 px-3 py-1 rounded-full text-[10px] font-bold border border-green-500/30">CONFIRM ‚úÖ</button>
                </div>

                <textarea id="playersInput" class="w-full bg-black/40 border border-white/10 p-4 rounded-2xl text-sm outline-none" placeholder="Enter Players (One per line)" rows="4"></textarea>

                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-black/30 p-2 rounded-xl border border-white/5">
                        <p class="text-[8px] uppercase text-gray-500 font-bold">Courts</p>
                        <input id="courtsInput" type="number" value="1" class="bg-transparent w-full text-white font-bold outline-none">
                    </div>
                    <div class="bg-black/30 p-2 rounded-xl border border-white/5">
                        <p class="text-[8px] uppercase text-gray-500 font-bold">Match Type</p>
                        <select id="matchMode" class="bg-transparent w-full text-white font-bold text-[10px] outline-none">
                            <option value="random">Randomize</option>
                            <option value="mixed">Mixed M/F</option>
                        </select>
                    </div>
                </div>

                <div class="flex gap-2">
                    <button onclick="runMatchEngine()" class="flex-1 bg-yellow-400 text-blue-900 font-black py-4 rounded-2xl uppercase shadow-lg">Generate Round</button>
                    <button onclick="resetArena()" class="bg-red-500/20 text-red-400 px-5 rounded-2xl border border-red-500/20">üóëÔ∏è</button>
                </div>
            </div>

            <div id="matchesSection" class="hidden mt-8 pb-20">
                <div id="matchesContainer" class="space-y-4"></div>
            </div>
        </div>

        <div id="view-business" class="tab-view px-6 pt-10">
            <h1 class="text-2xl font-black text-slate-900 uppercase">Coach <span class="text-blue-600">Hub</span></h1>
            <div class="bg-white p-6 rounded-[2rem] shadow-sm border mt-6">
                <p class="text-[10px] font-bold text-slate-400 uppercase">Current Session Revenue</p>
                <p id="revDisplay" class="text-4xl font-black italic text-slate-900 mt-1">R 0</p>
            </div>
            <button onclick="shareLink()" class="w-full mt-4 bg-slate-900 text-white py-4 rounded-2xl font-bold uppercase text-xs">Share Session üì§</button>
        </div>

        <div id="view-students" class="tab-view p-10 text-center text-slate-400 italic">Dojo coming soon...</div>
        <div id="view-tourney" class="tab-view p-10 text-center text-slate-400 italic">Tourney coming soon...</div>
    </div>

    <nav class="nav-dock">
        <button onclick="switchTab('arena')" id="btn-arena" class="nav-btn active"><span>üéæ</span><span class="text-[8px] font-bold mt-1 uppercase">Arena</span></button>
        <button onclick="switchTab('business')" id="btn-business" class="nav-btn"><span>üìä</span><span class="text-[8px] font-bold mt-1 uppercase">Hub</span></button>
        <button onclick="switchTab('students')" id="btn-students" class="nav-btn"><span>üë•</span><span class="text-[8px] font-bold mt-1 uppercase">Dojo</span></button>
        <button onclick="switchTab('tourney')" id="btn-tourney" class="nav-btn"><span>üèÜ</span><span class="text-[8px] font-bold mt-1 uppercase">Tourney</span></button>
    </nav>
</div>

<script>
    // 1. CONFIG
    const firebaseConfig = {
        apiKey: "AiZaSyAKJywAbSKpKHqOs1a-_nQVBuQGkFmF4d4",
        authDomain: "padelpilot-4531f.firebaseapp.com",
        databaseURL: "https://padelpilot-4531f-default-rtdb.firebaseio.com",
        projectId: "padelpilot-4531f",
        storageBucket: "padelpilot-4531f.appspot.com",
        messagingSenderId: "866905934997",
        appId: "1:866905934997:web:97cb8ebc4ed35f9e41f9c"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 2. CORE UTILS
    function switchTab(tabId) {
        document.querySelectorAll('.tab-view').forEach(v => v.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('view-' + tabId).classList.add('active');
        document.getElementById('btn-' + tabId).classList.add('active');
    }
